<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Family Day Event</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overscroll-behavior-y: contain;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ====================================================================
        // CONFIGURATION - CUSTOMIZE HERE
        // ====================================================================
        
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby1uKSIykaTSFb21OPY_ZEipy_pUzjXOc8dl0bk9IqWhUx3IwznlBXJiHBQ7u0ThVaawQ/exec';
        const REFRESH_INTERVAL = 30000; // Refresh teams every 30 seconds

        const SAMPLE_QR_CODES = {
            station1: 'https://lexfoong91.github.io/PC4FamilyDay/Game1.jpg',
            station2: 'https://lexfoong91.github.io/PC4FamilyDay/Game2.jpg',
            station3: 'https://lexfoong91.github.io/PC4FamilyDay/Game3.jpg',
            station4: 'https://lexfoong91.github.io/PC4FamilyDay/Game4.jpg',
            station5: 'https://lexfoong91.github.io/PC4FamilyDay/Game5.jpg',
            station6: 'https://lexfoong91.github.io/PC4FamilyDay/Game6.jpg',
            station7: 'https://lexfoong91.github.io/PC4FamilyDay/Game7.jpg',
            //station8: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Crect fill="%23fff" width="200" height="200"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-size="16" fill="%23000"%3EStation 8%3C/text%3E%3C/svg%3E'
        };

        const MAP_BACKGROUNDS = {
            1: 'https://lexfoong91.github.io/PC4FamilyDay/Level1.png',
            2: 'https://lexfoong91.github.io/PC4FamilyDay/Level2.png',
            3: 'https://lexfoong91.github.io/PC4FamilyDay/Level3.png'
        };

        // SAMPLE DATA - Used when Google Sheets is not configured
        const SAMPLE_TEAMS = [
            { name: 'Team A', members: [
                { id: 1, name: 'Member A1', present: false },
                { id: 2, name: 'Member A2', present: false },
                { id: 3, name: 'Member A3', present: false },
                { id: 4, name: 'Member A4', present: false }
            ]},
            { name: 'Team B', members: [
                { id: 5, name: 'Member B1', present: false },
                { id: 6, name: 'Member B2', present: false },
                { id: 7, name: 'Member B3', present: false },
                { id: 8, name: 'Member B4', present: false }
            ]},
            { name: 'Team C', members: [
                { id: 9, name: 'Member C1', present: false },
                { id: 10, name: 'Member C2', present: false },
                { id: 11, name: 'Member C3', present: false },
                { id: 12, name: 'Member C4', present: false }
            ]}
        ];

        const STATION_CONFIG = [
            { 
                id: 'station1', 
                name: 'Station 1', 
                level: 1, 
                x: '20%', 
                y: '30%',
                answerHint: 'Answer can be found at the information board near the entrance',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game1-KnightTour.html'
            },
            { 
                id: 'station2', 
                name: 'Station 2', 
                level: 1, 
                x: '70%', 
                y: '30%',
                answerHint: 'Answer can be found at the reception counter display',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game2-Minesweeper.html'
            },
            { 
                id: 'station3', 
                name: 'Station 3', 
                level: 1, 
                x: '45%', 
                y: '70%',
                answerHint: 'Answer can be found at the community notice board',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game3-CarEscape.html'
            },
            { 
                id: 'station4', 
                name: 'Station 4', 
                level: 2, 
                x: '70%', 
                y: '30%',
                answerHint: 'Answer can be found at the exhibition hall poster',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game4-Snake.html'
            },
            { 
                id: 'station5', 
                name: 'Station 5', 
                level: 2, 
                x: '45%', 
                y: '70%',
                answerHint: 'Answer can be found at the activity zone signage',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game5-Memory.html'
            },
            { 
                id: 'station6', 
                name: 'Station 6', 
                level: 3, 
                x: '20%', 
                y: '30%',
                answerHint: 'Answer can be found at the heritage corner display',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game6-FlappyBird.html'
            },
            { 
                id: 'station7', 
                name: 'Station 7', 
                level: 3, 
                x: '70%', 
                y: '30%',
                answerHint: 'Answer can be found at the main lobby information desk',
                gameUrl: 'https://lexfoong91.github.io/PC4FamilyDay/Game7-Puzzle.html'
            }
        ];

        // Icon Components
        const ChevronLeft = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('path', { d: 'M15 18l-6-6 6-6' })
        );

        const Users = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('path', { d: 'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }),
            React.createElement('circle', { cx: 9, cy: 7, r: 4 }),
            React.createElement('path', { d: 'M23 21v-2a4 4 0 0 0-3-3.87' }),
            React.createElement('path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' })
        );

        const MapIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('polygon', { points: '1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6' }),
            React.createElement('line', { x1: 8, y1: 2, x2: 8, y2: 18 }),
            React.createElement('line', { x1: 16, y1: 6, x2: 16, y2: 22 })
        );

        const Send = () => React.createElement('svg', { width: 18, height: 18, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('line', { x1: 22, y1: 2, x2: 11, y2: 13 }),
            React.createElement('polygon', { points: '22 2 15 22 11 13 2 9 22 2' })
        );

        const Check = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('polyline', { points: '20 6 9 17 4 12' })
        );

        const XIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('line', { x1: 18, y1: 6, x2: 6, y2: 18 }),
            React.createElement('line', { x1: 6, y1: 6, x2: 18, y2: 18 })
        );

        const HelpCircle = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('circle', { cx: 12, cy: 12, r: 10 }),
            React.createElement('path', { d: 'M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3' }),
            React.createElement('line', { x1: 12, y1: 17, x2: 12.01, y2: 17 })
        );

        const RefreshIcon = () => React.createElement('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            React.createElement('polyline', { points: '23 4 23 10 17 10' }),
            React.createElement('polyline', { points: '1 20 1 14 7 14' }),
            React.createElement('path', { d: 'M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15' })
        );

        // Main App
        function FamilyDayApp() {
            const [currentPage, setCurrentPage] = useState('home');
            const [selectedTeam, setSelectedTeam] = useState(null);
            const [selectedStation, setSelectedStation] = useState(null);
            const [teams, setTeams] = useState([]);
            const [qrImages, setQrImages] = useState(SAMPLE_QR_CODES);
            const [sendStatus, setSendStatus] = useState('');
            const [showInstructions, setShowInstructions] = useState(false);
            const [currentLevel, setCurrentLevel] = useState(1);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            // Fetch teams from Google Sheets
            const fetchTeams = async () => {
                try {
                    if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_WEB_APP_URL') {
                        console.log('Demo mode - Using sample data');
                        const teamsWithMembers = SAMPLE_TEAMS.filter(team => team.members && team.members.length > 0);
                        setTeams(teamsWithMembers);
                        setLoading(false);
                        return;
                    }

                    const response = await fetch(`${APPS_SCRIPT_URL}?action=getTeams&timestamp=${Date.now()}`);
                    const data = await response.json();
                    
                    if (data.success && data.teams) {
                        const teamsWithMembers = data.teams.filter(team => team.members && team.members.length > 0);
                        setTeams(teamsWithMembers);
                        setError(null);
                    } else {
                        throw new Error('Failed to fetch teams');
                    }
                } catch (err) {
                    console.error('Error fetching teams:', err);
                    setError('Failed to load teams. Using sample data.');
                    const teamsWithMembers = SAMPLE_TEAMS.filter(team => team.members && team.members.length > 0);
                    setTeams(teamsWithMembers);
                } finally {
                    setLoading(false);
                }
            };

            useEffect(() => {
                fetchTeams();
                const interval = setInterval(fetchTeams, REFRESH_INTERVAL);
                return () => clearInterval(interval);
            }, []);

            const toggleAttendance = (memberId) => {
                setTeams(teams.map(team => {
                    if (team.name === selectedTeam) {
                        return {
                            ...team,
                            members: team.members.map(member =>
                                member.id === memberId ? { ...member, present: !member.present } : member
                            )
                        };
                    }
                    return team;
                }));
            };

            const handleSendToGoogleSheets = async () => {
                setSendStatus('sending');

                const selectedTeamData = teams.find(t => t.name === selectedTeam);
                if (!selectedTeamData) {
                    alert('Error: Team not found');
                    setSendStatus('');
                    return;
                }

                const attendanceData = {
                    teamName: selectedTeamData.name,
                    members: selectedTeamData.members.map(m => ({
                        name: m.name,
                        present: m.present
                    })),
                    timestamp: new Date().toISOString()
                };

                try {
                    if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_WEB_APP_URL') {
                        console.log('Demo mode - Sample data:', attendanceData);
                        alert('‚ö†Ô∏è Please configure APPS_SCRIPT_URL first!\n\nReplace YOUR_GOOGLE_SCRIPT_WEB_APP_URL with your actual Google Apps Script URL.');
                        setSendStatus('');
                        return;
                    }

                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = APPS_SCRIPT_URL;
                    form.target = '_blank';

                    const actionInput = document.createElement('input');
                    actionInput.type = 'hidden';
                    actionInput.name = 'action';
                    actionInput.value = 'saveAttendance';
                    form.appendChild(actionInput);

                    const dataInput = document.createElement('input');
                    dataInput.type = 'hidden';
                    dataInput.name = 'data';
                    dataInput.value = JSON.stringify(attendanceData);
                    form.appendChild(dataInput);

                    document.body.appendChild(form);
                    form.submit();
                    document.body.removeChild(form);

                    setSendStatus('success');
                    setTimeout(() => setSendStatus(''), 3000);
                    
                } catch (error) {
                    console.error('Error sending to Google Sheets:', error);
                    setSendStatus('error');
                    setTimeout(() => setSendStatus(''), 3000);
                }
            };

            if (showInstructions) {
                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-screen overflow-y-auto">
                            <div className="sticky top-0 bg-indigo-600 text-white p-6 rounded-t-2xl">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-bold">How to Use</h2>
                                    <button onClick={() => setShowInstructions(false)} className="text-white hover:bg-indigo-700 rounded-full p-2">
                                        <XIcon />
                                    </button>
                                </div>
                            </div>
                            <div className="p-6 space-y-6">
                                <div>
                                    <div className="flex items-center gap-2 mb-3">
                                        <div className="w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
                                        <h3 className="text-lg font-bold text-gray-800">Record Attendance</h3>
                                    </div>
                                    <div className="text-gray-700 pl-10 space-y-2">
                                        <p><b>Step 1:</b> Tap your team (A-J)</p>
                                        <p><b>Step 2:</b> Tap names to mark present</p>
                                        <p><b>Step 3:</b> Tap Send to Sheets</p>
                                    </div>
                                </div>
                                <div className="border-t pt-6">
                                    <div className="flex items-center gap-2 mb-3">
                                        <div className="w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
                                        <h3 className="text-lg font-bold text-gray-800">View QR Codes</h3>
                                    </div>
                                    <div className="text-gray-700 pl-10 space-y-2">
                                        <p><b>Step 1:</b> Tap Map icon</p>
                                        <p><b>Step 2:</b> Select Level 1, 2, or 3</p>
                                        <p><b>Step 3:</b> Tap station number</p>
                                    </div>
                                </div>
                            </div>
                            <div className="sticky bottom-0 bg-gray-50 p-4 rounded-b-2xl">
                                <button onClick={() => setShowInstructions(false)} className="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700">
                                    Got It!
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (currentPage === 'home') {
                if (loading) {
                    return (
                        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                            <div className="bg-white rounded-2xl shadow-xl p-8 text-center">
                                <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"></div>
                                <p className="text-gray-600">Loading teams...</p>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
                                <div className="flex items-center justify-between mb-6">
                                    <h1 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                                        <Users />
                                        Family Day Event
                                    </h1>
                                    <div className="flex gap-2">
                                        <button onClick={() => setShowInstructions(true)} className="p-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">
                                            <HelpCircle />
                                        </button>
                                        <button onClick={() => setCurrentPage('map')} className="p-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                                            <MapIcon />
                                        </button>
                                    </div>
                                </div>
                                <div className="flex items-center justify-between">
                                    <p className="text-gray-600">Select your team to mark attendance</p>
                                    <button onClick={fetchTeams} className="text-sm text-indigo-600 hover:text-indigo-700 font-semibold flex items-center gap-1">
                                        <RefreshIcon /> Refresh
                                    </button>
                                </div>
                                {error && (
                                    <div className="mt-3 p-3 bg-yellow-100 text-yellow-800 rounded-lg text-sm">
                                        {error}
                                    </div>
                                )}
                            </div>
                            {teams.length === 0 ? (
                                <div className="bg-white rounded-2xl shadow-xl p-8 text-center">
                                    <p className="text-gray-600 text-lg">No teams available</p>
                                    <p className="text-gray-500 text-sm mt-2">Please add teams in Google Sheets</p>
                                </div>
                            ) : (
                                <div className="grid grid-cols-2 gap-3">
                                    {teams.map((team, idx) => {
                                        const presentCount = team.members.filter(m => m.present).length;
                                        const teamLetter = team.name.split(' ')[1] || team.name.charAt(team.name.length - 1);
                                        return (
                                            <button key={idx} onClick={() => { setSelectedTeam(team.name); setCurrentPage('attendance'); }}
                                                className="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition">
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold text-indigo-600 mb-1">
                                                        {teamLetter}
                                                    </div>
                                                    <h3 className="text-sm font-semibold text-gray-800 mb-2">{team.name}</h3>
                                                    <div className="flex justify-center items-center gap-1 text-xs">
                                                        <div className="w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-white font-bold text-xs">
                                                            {presentCount}
                                                        </div>
                                                        <span>/ {team.members.length}</span>
                                                    </div>
                                                </div>
                                            </button>
                                        );
                                    })}
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            if (currentPage === 'attendance') {
                const team = teams.find(t => t.name === selectedTeam);
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
                                <div className="flex items-center gap-3 mb-6">
                                    <button onClick={() => setCurrentPage('home')} className="p-2 hover:bg-gray-100 rounded-lg">
                                        <ChevronLeft />
                                    </button>
                                    <div>
                                        <h2 className="text-2xl font-bold text-gray-800">{team.name}</h2>
                                        <p className="text-sm text-gray-600">Tap to mark attendance</p>
                                    </div>
                                </div>
                                <button onClick={handleSendToGoogleSheets} disabled={sendStatus === 'sending'}
                                    className="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 mb-4 flex items-center justify-center gap-2 disabled:bg-gray-400">
                                    <Send />
                                    {sendStatus === 'sending' ? 'Sending...' : 'Send to Sheets'}
                                </button>
                                {sendStatus === 'success' && (
                                    <div className="mb-4 p-3 bg-green-100 text-green-800 rounded-lg text-center font-semibold">
                                        ‚úì Attendance sent successfully!
                                    </div>
                                )}
                                {sendStatus === 'error' && (
                                    <div className="mb-4 p-3 bg-red-100 text-red-800 rounded-lg text-center font-semibold">
                                        ‚úó Error sending data. Please try again.
                                    </div>
                                )}
                            </div>
                            <div className="space-y-3">
                                {team.members.map((member) => (
                                    <button key={member.id} onClick={() => toggleAttendance(member.id)}
                                        className={`w-full p-5 rounded-xl shadow-md transition ${
                                            member.present ? 'bg-gradient-to-r from-green-400 to-green-500 text-white' : 'bg-white text-gray-800'
                                        }`}>
                                        <div className="flex items-center justify-between">
                                            <span className="text-lg font-semibold">{member.name}</span>
                                            <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                                                member.present ? 'bg-white text-green-500' : 'bg-red-500 text-white'
                                            }`}>
                                                {member.present ? <Check /> : <XIcon />}
                                            </div>
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            if (currentPage === 'map') {
                const currentStations = STATION_CONFIG.filter(s => s.level === currentLevel);

                if (selectedStation) {
                    const stationInfo = STATION_CONFIG.find(s => s.id === selectedStation);
                    
                    return (
                        <div className="min-h-screen bg-gradient-to-br from-purple-50 to-pink-100 p-4">
                            <div className="max-w-md mx-auto">
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    <div className="flex items-center gap-3 mb-6">
                                        <button onClick={() => setSelectedStation(null)} className="p-2 hover:bg-gray-100 rounded-lg">
                                            <ChevronLeft />
                                        </button>
                                        <h2 className="text-2xl font-bold text-gray-800">
                                            {stationInfo?.name}
                                        </h2>
                                    </div>
                                    
                                    {/* Answer Hint Section */}
                                    <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg">
                                        <div className="flex items-start">
                                            <div className="flex-shrink-0">
                                                <svg className="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clipRule="evenodd" />
                                                </svg>
                                            </div>
                                            <div className="ml-3">
                                                <p className="text-sm font-semibold text-yellow-800 mb-1">üìç Answer Location</p>
                                                <p className="text-sm text-yellow-700">
                                                    {stationInfo?.answerHint || 'Answer can be found at the station'}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Clickable QR Code */}
                                    <div className="bg-gray-100 rounded-xl p-4 mb-4">
                                        <a 
                                            href={stationInfo?.gameUrl} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="block hover:opacity-80 transition-opacity"
                                        >
                                            <img 
                                                src={qrImages[selectedStation]} 
                                                alt="QR Code" 
                                                className="w-full max-w-xs mx-auto rounded-lg shadow-md cursor-pointer hover:scale-105 transition-transform" 
                                            />
                                        </a>
                                    </div>
                                    
                                    {/* Instruction Text */}
                                    <div className="text-center">
                                        <p className="text-gray-600 text-sm mb-2">
                                            üëÜ Tap QR code or scan to start the game
                                        </p>
                                        <a 
                                            href={stationInfo?.gameUrl} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="inline-block bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors"
                                        >
                                            üéÆ Open Game Directly
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-50 to-pink-100 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
                                <div className="flex items-center gap-3 mb-6">
                                    <button onClick={() => setCurrentPage('home')} className="p-2 hover:bg-gray-100 rounded-lg">
                                        <ChevronLeft />
                                    </button>
                                    <h2 className="text-2xl font-bold text-gray-800">Event Map</h2>
                                </div>
                                <div className="flex justify-center gap-2">
                                    {[1, 2, 3].map(level => (
                                        <button key={level} onClick={() => setCurrentLevel(level)}
                                            className={`px-6 py-2 rounded-lg font-semibold ${
                                                currentLevel === level ? 'bg-purple-600 text-white' : 'bg-gray-200 text-gray-700'
                                            }`}>
                                            Level {level}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                
                                <div className="relative w-full rounded-xl overflow-hidden" style={{ paddingTop: '75%' }}>
                                    {/* Background Map Image - Responsive */}
                                    <img 
                                        src={MAP_BACKGROUNDS[currentLevel]} 
                                        alt={`Level ${currentLevel} Map`}
                                        className="absolute inset-0 w-full h-full object-contain"
                                    />
                                    
                                    {/* Station Buttons Overlaid on Map */}
                                    <div className="absolute inset-0">
                                        {currentStations.map((station) => (
                                            <button 
                                                key={station.id} 
                                                onClick={() => setSelectedStation(station.id)}
                                                className="absolute bg-purple-600 text-white rounded-full shadow-lg hover:shadow-xl hover:scale-110 transition-all flex items-center justify-center font-bold border-4 border-white"
                                                style={{ 
                                                    left: station.x, 
                                                    top: station.y, 
                                                    transform: 'translate(-50%, -50%)',
                                                    zIndex: 10,
                                                    width: 'clamp(48px, 10vw, 64px)',
                                                    height: 'clamp(48px, 10vw, 64px)',
                                                    fontSize: 'clamp(14px, 2.5vw, 18px)'
                                                }}>
                                                {station.name.split(' ')[1]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                <p className="text-center text-gray-600 mt-4 font-semibold">Tap any station to view QR code</p>
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        }

        ReactDOM.render(<FamilyDayApp />, document.getElementById('app'));
    </script>
</body>
</html>